"use strict";const input=document.querySelector(".js-input"),btn=document.querySelector(".js-button"),listMovies=document.querySelector(".js-main__list"),url="//api.tvmaze.com/search/shows?q=",imgPlaceholder="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",resetAllFavorites=document.querySelector(".js-reset"),logBtn=document.querySelector(".js-log"),mainSectionPopcorn=document.querySelector(".js-popcorn");let movies=[],arrFavoriteList=[];function getData(){fetch(url+input.value).then(e=>e.json()).then(e=>{movies=e,paintMovies(),listenFavMovies(),paintFavorite(),listenTrashItem(),mainSection()})}const mainSection=()=>{mainSectionPopcorn.classList.add("main__hidden")};function paintMovies(){let e="";for(let i=0;i<movies.length;i++){let t,s,a;-1!==arrFavoriteList.findIndex(e=>e.show.id===movies[i].show.id)?(t="color-favorite",s="",a="hidden"):(t="",s="hidden",a="");const o=movies[i].show.image;e+=`<li class = "main__container ${t}" id="${movies[i].show.id}">`,e+=null!==o?`<img class = "main__img ${a}  " src="${movies[i].show.image.medium}" alt="${movies[i].show.name}" />`:`<img class = "main__img ${a}" src="${imgPlaceholder}" alt="${movies[i].show.name}" />`,e+=`<div class="main__text ${a} "> <h3 class = "main__name">${movies[i].show.name}</h3></div>`,e+=`<div class="${s}">`,e+=null!==o?`<div class="main__imgStart"><img class = "main__img main__details " src="${movies[i].show.image.medium}" alt="${movies[i].show.name}" /><i class="far fa-star main__star ${s}"></i></div>`:`<div class="main__imgStart"><img class = "main__img main__details" src="${imgPlaceholder}" alt="${movies[i].show.name}" /><i class="far fa-star main__star ${s}"></i></div>`,e+=`<h3> ${movies[i].show.name}</h3>`,e+=`<p><h4>Género:</h4>${movies[i].show.genres} </p>`,e+=`<p><h4>Estreno:</h4>${movies[i].show.premiered} </p>`,e+=`<p><h4>Idioma:</h4>${movies[i].show.language} </p>`,e+="</div>",e+="</li>"}listMovies.innerHTML=e,listenFavMovies()}function handleFilter(){getData()}function favMovies(e){const i=e.currentTarget,t=parseInt(i.id),s=arrFavoriteList.findIndex(e=>{if(parseInt(e.show.id)===t)return e});if(-1===s){const e=movies.find(e=>{if(parseInt(e.show.id)===t)return e});arrFavoriteList.push(e),i.classList.add("color-favorite")}else arrFavoriteList.splice(s,1);paintMovies(),listenFavMovies(),paintFavorite(),listenTrashItem(),setLocalStorage()}function paintFavorite(){const e=document.querySelector(".js-main__aside--fav");let i="";for(let e=0;e<arrFavoriteList.length;e++)i+=`<li class = "main__container--fav" id="${arrFavoriteList[e].show.id}">`,null!==arrFavoriteList[e].show.image?i+=`<img class = "main__img--fav" src="${arrFavoriteList[e].show.image.medium}" alt="${arrFavoriteList[e].show.name}" />`:i+=`<img class = "main__img--fav" src="${imgPlaceholder}" alt="${arrFavoriteList[e].show.name}" />`,i+=`<h3 class = "main__name--fav">${arrFavoriteList[e].show.name}</h3>`,i+=`<i class="fas fa-trash js-reset-items" id="${e}"></i>`,i+="</li>";e.innerHTML=i,listenFavMovies()}function setLocalStorage(){localStorage.setItem("LocalStorageList",JSON.stringify(arrFavoriteList))}function getLocalStorage(){arrFavoriteList=JSON.parse(localStorage.getItem("LocalStorageList")),null===arrFavoriteList&&(arrFavoriteList=[]),paintMovies(),listenFavMovies(),paintFavorite(),listenTrashItem()}function resetFavorites(){arrFavoriteList.splice(1,arrFavoriteList.length),arrFavoriteList=[],localStorage.clear(),paintFavorite()}function resetItemFavorites(e){const i=e.currentTarget.id;arrFavoriteList.splice(i,1),paintFavorite(),listenFavMovies(),listenTrashItem(),setLocalStorage()}function clickBtn(){alert("Esta acción esta en construcción, perdón por las molestias")}function listenFavMovies(){const e=document.querySelectorAll(".main__container");for(const i of e)i.addEventListener("click",favMovies)}function listenTrashItem(){const e=document.querySelectorAll(".js-reset-items");for(const i of e)i.addEventListener("click",resetItemFavorites)}function buttonsSignIn(){const e=document.querySelectorAll(".js-popBtn");for(const i of e)i.addEventListener("click",clickBtn)}getLocalStorage(),btn.addEventListener("click",handleFilter),resetAllFavorites.addEventListener("click",resetFavorites),buttonsSignIn();